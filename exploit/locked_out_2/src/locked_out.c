#include <stdint.h>
#include <stdio.h>
#include <string.h>

const char *enc_password = E_PASSWORD;
const char *enc_flag = E_FLAG;

uint8_t rol(uint8_t b, uint8_t n) {
    return (b << n) | (b >> (8 - n));
}
void decrypt(char *dst, const char *src, uint8_t n) {
    size_t i;
    for (i = 0; i < strlen(src) + 1; i++) {
        dst[i] = rol(src[i], n);
    }
}

void print_flag() {
    char flag[256];
    decrypt(flag, enc_flag, ROT);
    puts(flag);
}

int main() {
    setbuf(stdout, NULL);

    puts("I've got the flag, but I ain't gonna give it to you unless you've got the password.");
    puts("Nothing personal, I'm sure you'll understand I can't trust strangers...");

    fputs("Password: ", stdout);
    char input[256];
    gets(input);

    char password[64];
    decrypt(password, enc_password, ROT);
    if (strcmp(input, password) != 0) {
        puts("Yeah that's not the password, no flag for you.");
        return 1;
    }

    fputs("I guess I can trust you! Here's the flag: ", stdout);
    print_flag();
    return 0;
}
